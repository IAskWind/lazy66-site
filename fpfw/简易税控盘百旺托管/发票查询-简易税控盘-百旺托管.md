# 发票查询-简易税控盘-百旺托管

- 接口描述：`发票查询`
- 接口名称：`lazy.opweb.bwtg.jyskpapi.fpcx`
- 接口版本：1.0
- 接口说明：发票查询接口实现通过接口读取开票中心发票开具明细信息。按发票代码发票号码查询时，仅支持查询单张发票明细；按交易流水号查询可以查询该流水号开具的发票信息

##### 请求报文：

```xml
<?xml version="1.0" encoding="utf-8"?>
<business comment="发票查询" id="FPCX" version='1.0'>
    <body yylxdm="1">
        <input>
           <jsbh><![CDATA[${nsrsbh}~~${kpzdbs}]]></jsbh>
           <fplxdm>026</fplxdm>
           <cxfs>0</cxfs>
           <cxtj>05000352110710119624</cxtj>
        </input>
    </body>
</business>
```

###### 请求参数说明：

| 索引 |     ID     |       名称       | 长度  | 必须 | 说明                                                         |
| :--: | :--------: | :--------------: | ----- | ---- | ------------------------------------------------------------ |
|  1   |   jsbh   |      机身编号      | 100  | 是   | 纳税人识别号+开票终端标识(使用英文~~符合分隔) |
|  2   | fplxdm |     发票类型代码     | 3 | 是   |           |
|  3  |  cxfs |      查询方式      | 1 | 是   | 0：按发票号码查询  1：按请求流水号查询 |
| 4 | cxtj | 查询条件 |  | 是 | cxfs为0时：发票代码+发票号码  cxfs为1时:发票交易流水号 |



##### 返回报文(税控xml说明)：

```xml
<?xml version="1.0" encoding="utf-8"?>
<business id="FPCX">
    <body>
        <returncode>0</returncode>
        <returnmsg>查询成功</returnmsg>
        <returndata>
            <kpxx>
                <fpdm>050003521107</fpdm>
				<fphm>10119624</fphm>
                <fpzt>00</fpzt>
                <sksbbh>499000154056</sksbbh>
                <kprq>20191023151629</kprq>
                <ghdwsbh>340404198709200854</ghdwsbh>
                <ghdwmc><![CDATA[测试]]></ghdwmc>
                <hjje>6.0</hjje>
                <hjse>0.36</hjse>
                <jshj>6.36</jshj>		                                             <url>fpnc.bwjf.cn/downInvoice/19bc1405f4944e3ebb0c39d2f5715f32</url>
                <skm><![CDATA[03*28410/&lt;9+167-4-685&lt;2+-&gt;753&lt;&gt;4-609946*9&lt;&lt;/-3/+94&gt;+&gt;88123/3160&gt;&lt;-+509448-*&lt;03&gt;3&lt;176957325939&gt;0151411926+&gt;+5&lt;2+9]]></skm>
                <jym>18397513763813607657</jym>
            </kpxx>
        </returndata>
    </body>
</business>
```

###### 返回参数说明：

| 索引 | ID         | 名称             | 长度 | 必须 | 说明                                                         |
| ---- | ---------- | ---------------- | ---- | ---- | ------------------------------------------------------------ |
| 1    | id         | 交易编号         | 5    | 是   | FPCX                                                         |
| 2    | returncode | 返回代码         | 8    | 是   | 0成功，其它失败                                              |
| 3    | returnmsg  | 返回信息         | 160  | 是   |                                                              |
| 4    | fpdm       | 发票代码         | 12   | 是   |                                                              |
| 5    | fphm       | 发票号码         | 8    | 是   |                                                              |
| 6    | fpzt       | 发票状态         | 2    | 是   | 00：已开具的正数发票；   01：已开具的负数发票；   02：未开具发票的作废发票；   03：已开具正数发票的作废发票；   04：已开具负数发票的作废发票； |
| 7    | sksbbh     | 税控设备编号     | 12   | 是   | 税控盘的编号                                                 |
| 8    | kprq       | 开票日期         | 14   | 是   | 格式:YYYYMMDDHHMMSS                                          |
| 9    | ghdwsbh    | 购货单位识别号   | 20   | 否   | 15-20位数字或字母   增值税普票可以为空                       |
| 10   | ghdwmc     | 购货单位名称     | 100  | 是   |                                                              |
| 11   | hjje       | 合计金额         | 12   | 是   | 小数点后2位，不含税，正负                                    |
| 12   | hjse       | 合计税额         | 12   | 是   | 小数点后2位，正负                                            |
| 13   | jshj       | 加税合计         | 12   | 是   | 小数点后2位，正负                                            |
| 14   | url        | 电子发票下载地址 | 200  | 否   | 电子发票下载地址，电子发票时返回，其他发票时该字段为空       |